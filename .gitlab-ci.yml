include:
  - project: SocialGouv/gitlab-ci-yml
    file: /autodevops.yml
    ref: v23.0.1

variables:
  AUTO_DEVOPS_KANIKO: "üêé"
  AUTO_DEVOPS_RELEASE_AUTO: "üîñ"
  AUTO_DEVOPS_PRODUCTION_AUTO: "üöÄ"

Build:
  extends: .autodevops_build
  artifacts:
    expire_in: 1 day
    paths:
      - dist/

Release:
  before_script:
    - git remote set-url origin https://${GITHUB_TOKEN}@github.com/${CI_PROJECT_ROOT_NAMESPACE}/${CI_PROJECT_TITLE}.git

# NOTE(julienbouquillon): use custom register job
# By default, kosko-charts use a "/app" for default docker images names
# TODO: discuss
Register Kaniko image:
  extends: .autodevops_register_kaniko_image
  variables:
    IMAGE_NAME: archifiltre-statistics
